<template>
    <div class="search-title">
        <span>Pesquisar <b>PRODUTO</b>:</span>
    </div>
    
    <c-custom-order-search object-name="Product2" pricebook-list-id={priceBookListId} field-name="Name" onshowresults={showResults} label="Pesquisar PRODUTO:" placeholder="Digite o nome do Produto" required="true" onchild={getFieldsValueProduct}></c-custom-order-search>

	<div class="row" style="width: 100%;" if:true={showBaseProducts}>
		<template for:each={baseProducts} for:item="prod">
			<div key={prod.Id} class="card">
				<div class="container">
					<div class="card-01">
						<p class="product-name">{prod.Name}</p>
						<p><b>Grupo:</b> {prod.productGroupName}</p>
						<p><b>Princípio ativo:</b> {prod.activePrinciple}</p>
					</div>
					<div class="card-02">
						<button class="include-button" data-target-id={prod.Id} onclick={showProductModal}>Incluir</button>
					</div>
				</div>
			</div>
		</template>
	</div>

	<div class="products-result" if:true={showIncludedProducts}>
        <template if:false={message}>
			<button class="change-columns" onclick={showTableColumns}>Alterar colunas</button>
            <h2>Resultados de <b>PRODUTOS</b>:</h2>

            <lightning-datatable class="slds-is-relative"
                data={products}
                columns={columns}
                key-field="id"
                onrowaction={handleRowActions}
            >
            </lightning-datatable>
        </template>
        
        <template if:true={message}>
            <h2>{message}</h2>
        </template>
    </div>

    <template if:true={createNewProduct}>
        <div id="product-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick={showProductModal}>&times;</span>
                <p class="new-product-title">Incluir novo produto: {addProduct.name}</p>

				<div class="row">
					<div class="column">
						<label>Unidade de Medida</label><br>
						<input class="input-design" type="text" value={addProduct.unity} disabled/> 
					</div>
					<div class="column">
						<label>Preço de Lista</label><br>
						<input class="input-design" type="number" value={addProduct.listPrice} disabled/>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<label>Dosagem</label><br>
						<input class="input-design" type="number" value={addProduct.dosage} onchange={changeValue} data-target-id="dosage"/>
					</div>
					<div class="column">
						<label>Quantidade</label><br>
						<input class="input-design" type="number" value={addProduct.quantity} onchange={changeValue} data-target-id="quantity"/>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<label>Preço Unitário</label><br>
						<input class="input-design" type="number" value={addProduct.unitPrice} onchange={changeValue} data-target-id="unitPrice"/>
					</div>
					<div class="column">
						<label>Preço Total</label><br>
						<input class="input-design" type="number" value={addProduct.totalPrice} disabled/>
					</div>
				</div>

				<hr class="line-divisor"/>
				<p class="title-divisor">Comercial</p>

				<div class="row">
					<div class="column">
						<label>Percentual de Desconto Comercial</label><br>
						<input class="input-design" type="text" value={addProduct.commercialDiscountPercentage} maxlength="8" onkeypress={changeToPercentage} onchange={changeValue} data-target-id="commercialDiscountPercentage"/>
					</div>
					<div class="column">
						<label>Valor de Desconto Comercial</label><br>
						<input class="input-design" type="number" value={addProduct.commercialDiscountValue} onchange={changeValue} data-target-id="commercialDiscountValue"/>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<label>Percentual de Acréscimo Comercial</label><br>
						<input class="input-design" type="text" value={addProduct.commercialAdditionPercentage} maxlength="8" onkeypress={changeToPercentage} onchange={changeValue} data-target-id="commercialAdditionPercentage"/>
					</div>
					<div class="column">
						<label>Valor de Acréscimo Comercial</label><br>
						<input class="input-design" type="number" value={addProduct.commercialAdditionValue} onchange={changeValue} data-target-id="commercialAdditionValue"/>
					</div>
				</div>

				<hr class="line-divisor"/>
				<p class="title-divisor">Financeiro</p>

				<div class="row">
					<div class="column">
						<label>Percentual de Acréscimo Financeiro</label><br>
						<input class="input-design" type="text" value={addProduct.financialAdditionPercentage} maxlength="8" onkeypress={changeToPercentage} onchange={changeValue} data-target-id="financialAdditionPercentage"/>
					</div>
					<div class="column">
						<label>Valor de Acréscimo Financeiro</label><br>
						<input class="input-design" type="number" value={addProduct.financialAdditionValue} onchange={changeValue} data-target-id="financialAdditionValue"/>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<label>Percentual de Decréscimo Financeiro</label><br>
						<input class="input-design" type="text" value={addProduct.financialDecreasePercentage} maxlength="8" onkeypress={changeToPercentage} onchange={changeValue} data-target-id="financialDecreasePercentage"/>
					</div>
					<div class="column">
						<label>Valor de Decréscimo Financeiro</label><br>
						<input class="input-design" type="number" value={addProduct.financialDecreaseValue} onchange={changeValue} data-target-id="financialDecreaseValue"/>
					</div>
				</div>

				<hr class="line-divisor"/>
				<p class="title-divisor">Informações Adicionais</p>

				<div class="row">
					<div class="column">
						<label>Quantidade Faturada</label><br>
						<input class="input-design" type="number" value={addProduct.invoicedQuantity} disabled/> 
					</div>
					<div class="column">
						<label>Princípio Ativo</label><br>
						<input class="input-design" type="text" value={addProduct.activePrinciple} onchange={changeValue} data-target-id="activePrinciple" disabled/>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<label>Grupo do Produto</label><br>
						<input class="input-design" type="text" value={addProduct.productGroupName} onchange={changeValue} data-target-id="productGroupName" disabled/>
					</div>
					<div class="column">
						<label>Status SAP</label><br>
						<input class="input-design" type="text" value={addProduct.sapStatus} disabled/>
					</div>
				</div>

				<div class="row">
					<div class="back-button">
						<a onclick={showProductModal}>Fechar</a>
					</div>
					<template if:true={updateProduct}>
						<div class="column">
							<button class="confirm-button" onclick={changeProduct}>Alterar Produto</button>
						</div>
					</template>
					<template if:false={updateProduct}>
						<div class="column">
							<button class="confirm-button" onclick={includeProduct}>Incluir Produto</button>
						</div>
					</template>
				</div>
            </div>
        </div>
    </template>

	<template if:true={changeColumns}>
        <div id="columns-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick={showTableColumns}>&times;</span>
				<p class="new-product-title">Escolha as colunas que deseja visualizar</p>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnUnity} data-target-id="columnUnity">
						<label class="column-title">Unidade de Medida</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnListPrice} data-target-id="columnListPrice">
						<label class="column-title">Preço de Lista</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnDosage} data-target-id="columnDosage">
						<label class="column-title">Dosagem</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnQuantity} data-target-id="columnQuantity">
						<label class="column-title">Quantidade</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnUnitPrice} data-target-id="columnUnitPrice">
						<label class="column-title">Preço Unitário</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnTotalPrice} data-target-id="columnTotalPrice">
						<label class="column-title">Preço Total</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnCommercialDiscountPercentage} data-target-id="columnCommercialDiscountPercentage">
						<label class="column-title">Percentual de Desconto Comercial</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnCommercialDiscountValue} data-target-id="columnCommercialDiscountValue">
						<label class="column-title">Valor de Desconto Comercial</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnCommercialAdditionPercentage} data-target-id="columnCommercialAdditionPercentage">
						<label class="column-title">Percentual de Acréscimo Comercial</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnCommercialAdditionValue} data-target-id="columnCommercialAdditionValue">
						<label class="column-title">Valor de Acréscimo Comercial</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnFinancialAdditionPercentage} data-target-id="columnFinancialAdditionPercentage">
						<label class="column-title">Percentual de Acréscimo Financeiro</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnFinancialAdditionValue} data-target-id="columnFinancialAdditionValue">
						<label class="column-title">Valor de Acréscimo Financeiro</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnFinancialDecreasePercentage} data-target-id="columnFinancialDecreasePercentage">
						<label class="column-title">Percentual de Decréscimo Financeiro</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnFinancialDecreaseValue} data-target-id="columnFinancialDecreaseValue">
						<label class="column-title">Valor de Decréscimo Financeiro</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnInvoicedQuantity} data-target-id="columnInvoicedQuantity">
						<label class="column-title">Quantidade Faturada</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnActivePrinciple} data-target-id="columnActivePrinciple">
						<label class="column-title">Princípio Ativo</label><br>
					</div>
				</div>

				<div class="row">
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnGroup} data-target-id="columnGroup">
						<label class="column-title">Grupo do Produto</label><br>
					</div>
					<div class="column">
						<input type="checkbox" class="column-input" onclick={changeTableColumns} checked={selectedColumns.columnSapStatus} data-target-id="columnSapStatus">
						<label class="column-title">Status SAP</label><br>
					</div>
				</div>

				<div class="row">
					<div class="back-button">
						<a onclick={showTableColumns}>Fechar</a>
					</div>
					<div class="column">
						<button class="confirm-button" onclick={applySelectedColumns}>Aplicar</button>
					</div>
				</div>
            </div>
        </div>
    </template>

    <!--Modal-->
    <c-modal-remessa></c-modal-remessa>
</template>